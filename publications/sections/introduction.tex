\subsection{Context and Motivation}
Many industrial systems are safety-critical, where process monitoring is essential to protect both profit and life. These dynamical systems operate at various operating points, often driven by control action to meet desired production goals. However, environmental fluctuations and varying component quality lead to unexpected and persistent changes in system behavior. These rare events can jeopardize optimal operations, accelerate wear and tear, and occasionally result in catastrophic consequences, such as equipment damage, production loss, or even human casualties.

Detecting abrupt and gradual changes in system behavior is crucial for ensuring system reliability and safety, a task known as change-point detection (CPD). Traditional methods like Statistical Process Control (SPC) rely on the assumption that data are independent and identically distributed (i.i.d.), which is often not the case in industrial systems. Industrial process data are typically correlated and non-stationary, complicating the application of SPC methods. While SCADA-based systems do not rely on i.i.d. and use static thresholds to detect changes, they cannot adapt to the dynamic changes in system behavior due to aging or environmental shifts.

Conventionally, offline machine learning (ML) methods are employed to identify macro-scale events in complex, high-dimensional dynamical systems. These methods depend on historical data and require offline training to detect system behavior changes. Although supervised ML methods with annotated data offer higher accuracy, they often fail in new contexts or when encountering unexpected data patterns. Moreover, these methods are impractical for existing industrial infrastructures where large-scale data collection is unfeasible, and direct integration with ongoing data exchange services is necessary.

Indeed, industrial data are streamed and arrive at non-uniform rates, which challenges the use of methods dependent on uniform sampling. For instance, \citet{Liu2023} simultaneousy detecting change points and anomalies by leveraging the rate of change, and \citet{Fathy2019} using cooperative adaptive filtering for change detection in wireless sensor networks both rassume i.i.d. Therefore, these methods may not be suitable for non-uniform data streams typical in industrial settings.

Sequential data in industrial systems comprise distinct components: linear, seasonal, cyclic, regressions, interventions, and errors. Effective CPD methods must adapt to these changing conditions over the system's lifetime. Additional consideration must be given to the type of change point we wish to detect. Variance change points, affect larger segments of time series, while additive change points are sudden pulses that die out quickly, and innovational change points are followed by gradual decay back to the original time series \citep{Srivastava2017}.

The key questions that arise are:
- Can wa detect changes in system behavior using streaming data?
- How can changes be detected in the presence of non-stationarity?
- Can we adapt to changing system behavior to maintain validity over the system's lifetime?

\subsection{Related Work}
Online CPD methods address the critical need for real-time monitoring in safety-critical industrial systems. Unlike offline CPD methods, which typically provide robust detection with significant delay, online CPD offers real-time solutions essential for timely intervention and maintenance planning. Indeed, offline methods often retrospect the historical data and detect changes in the system behavior after the event has occurred. In some settings, this may be acceptable, and favorable properties of offline methods might be enjoyed. For example, \citet{Liu2022} developed a CPD framework using a dynamic Bayesian network model to capture causal relationships between variables, enhancing interpretability and credibility. However, in industrial environments, real-time monitoring is imperative to prevent catastrophic outcomes such as equipment failure or production losses.

Self-supervised approaches are frequently used in online CPD due to the impracticality of obtaining real-time ground truth annotations. These methods leverage supervisory information from other online subsystems or raw data to maintain efficiency and generalization \citep{Zhang2024}. For instance, \citet{Korycki2021} utilized continual supervised approaches for CPD by incorporating labels from other subsystems.

% Refer to some successfully applied offline ML-based CPD methods (\citet{DeRyck2021}, ...)
Self-supervised approaches are frequently used in online CPD as obtaining ground truth information about the actual changes in real-time data is not feasible. However, they still rely on annotations to provide feedback. These may be available from other online subsystems that may provide labels for continual supervised CPD approaches such as~\citep{Korycki2021}. In most cases, the supervisory information is exploited directly from the raw unlabeled data, showing improved generalization abilities~\citep{Zhang2024}.  % Although the term self-supervision is mainly used in the machine learning community, we refer to any data-based system identification method as self-supervised, which relies on supervisory information solely generated by the data or the method itself.

\citet{Chu2022} proposes a sequential nearest neighbor search for high-dimensional and non-Euclidean data streams. A stopping rule is proposed to alert detected CP as soon as it occurs while providing a maximum boundary on a number of false positives. Despite its innovation, sensitivity of nearest neighbors methods to varying data densities and computational expense in high-dimensional spaces restricts its real-time applicability.

\citet{Gupta2022} proposed a three-phase architecture for real-time CPD using autoencoders (AE). However, the necessary preprocessing steps, such as shifting and scaling, require assumptions about data distribution that are often unknown in streaming scenarios. Additionally, recursive singular spectrum analysis may impose significant computational overhead in the case of high-dimensional data.

\citet{Bao2024} proposes feature decomposition and contrastive learning (CoCPD) for industrial time series to detect both abrupt CPs and subtle changepoints. By isolating predictable components from residual terms, this method improves detection accuracy in detecting subtle changes. Contrastive learning methods rely on constructing negative samples to increase the energy of the change points and decrease the energy of the ongoing opeartion data. Energy can be directly translated to change point detection statistics. Nevertheless, this is one of the main bottlenecks of contrastive learning methods. Since changes are unpredictable events that differ in sources and nature, it is challenging to generate negative samples to capture this variability as the prior information on the magnitudes and timing distributions are unknown, and the space of negative samples is therefore unbounded.

% Maybe did not understand the contribution well
A similar requirement is made in~\citet{Hayashi2019}, which relies on the ability to prompt the system to produce a response on specific input to examine the system behavior. This is rarely possible in industrial settings where the system is safety-critical, and the intervention may destabilize the system and interfere with achieving production goals. Moreover, the complex system model may not be available or accurate enough to predict the system response to the input.

Established statistical CPD methods promote interpretability while remaining highly competitive.~\citet{Rajaganapathy2022} introduced a Bayesian network-based CPD method, which is able to capture Ps characterized by step change leveraging causal relationships between the variables. Nevertheless, as we will explore soon, the change point may be characterized by a change in dynamics, which is better captured in the frequency domain rather than the time domain.

% Add transition

Many CPD algorithms compare past and future time series intervals using a dissimilarity measure, triggering alarms when intervals are sufficiently different. Statistical CPD methods usually compare the relative statistical differences between time intervals to identify change points (CPs). Temporal properties such as data distribution and time series models should be accurately modeled in advance to obtain more precise statistical metrics for evaluating interval homogeneity. These methods define this dissimilarity measure based on the difference in distribution of the two intervals. CUSUM and related methods \citet{Ye2023} track changes in the parameter of a chosen distribution, and the generalized likelihood ratio (GLR) procedure \citet{Xie2013, Korycki2021} monitors the likelihood that both intervals are generated from the same distribution. Transformer-based methods measure the distance between subspaces spanned by the columns of an observability matrix \citet{Moskvina2003, Kawahara2007} or observe reconstruction error~\citep{DeRyck2021, Bao2024}. Here, we will use transformer-based methods as an umbrella term for decomposition and deep neural network methods, which rely on finding the low-dimensional description of the data.  % TODO: If references needed

\subsection{Subspace-based (Transformer-based) CPD}
The main advantages of transformer-based approaches include absence of distributional assumptions and their ability to efficiently extract complex dynamical features from data. For example, \citet{Hirabaru2016} might be a powerful example of cost-effectiveness in high-dimensional systems. Authors finding a 1D subspace within multidimensional data and applying efficient univariate CPD, expanding their applicability to multivariate scenarios. This operates under the same assumption as \citet{Fathy2019} that the measurements are closely related and enable 1D representation to capture the signal from the noise. These approaches are not suitable for complex systems characterized by multiple weakly related quantities, whose behavior cannot be captured solely by the largest eigenvalue.

While some ML-based transformers demonstrate the ability to adapt and generalize to new data while retaining useful information over prolonged deployments \citep{Corizzo2022}, they lack guarantees that the CPD score accurately reflects the true dissimilarity between intervals. This issue, highlighted by \citet{DeRyck2021}, can lead to misjudgments about the severity of change points and result in poor decision-making. Additionally, transformer-based methods are sensitive to hyperparameter choices, often lacking informed guidance.

Subspace-based methods address these limitations by monitoring whether incoming data aligns with the null space of the reference state's observability matrix, effectively identifying new operating states \citep{Dohler2013, Ye2023}. \citet{Xie2013} leverage this principle in the MOUSSE (Multiscale Union of Subsets Model) algorithm, which tracks dynamic submanifolds in high-dimensional noisy data using a sequential generalized likelihood ratio procedure for CPD.

Numerous theoretical studies support the optimality of subspace-based methods in CPD. For instance, \citet{Ye2023} derive an exact subspace-CUSUM procedure and characterize average run length (ARL) and Type-II error probability using asymptotic random matrix theory, optimizing metrics such as expected detection delay (EDD). Similarly, \citet{Garreau2018} demonstrate that a kernel change-point algorithm can, with high probability, correctly identify the number and location of change points under well-chosen penalties, estimates the change-points location at the optimal rate.

The solid theoretical foundation of these methods is complemented by successful practical applications. For instance, \citet{Hosur2019} address the need for near real-time detection of changes in power systems' working conditions with a sequential detection algorithm based on stochastic subspace state-space identification, utilizing output-only covariance-based subspace identification with Hankel matrices. \citet{Dohler2013} propose a robust residual function for detecting changes in the eigenstructure of linear time-invariant systems for vibration monitoring. \citet{He2019} introduce ADMOST, an online subspace tracking framework similar to online SVD updated without increasing the rank, displaying its applicability to real-time UAV flight data, where anomaly detection and mitigation is required.

\subsection{DMD-based CPD}
In both autonomous and controlled dynamical systems, change points may be characterized by shifts in dynamics that are more effectively captured in the frequency domain rather than the time domain \citep{DeRyck2021, Gupta2022}. Addressing this issue requires decomposing a time series into its dominant frequency components, which are described by oscillations and magnitudes. For example, \citet{DeRyck2021} combined detection in both domains using two autoencoders in the TIRE method, leveraging discrete Fourier Transformation to extract spectral information. Similarly, \citet{Gupta2022} utilized recursive singular spectrum analysis in preprocessing within an autoencoder-based CPD framework to decompose time series into dominant frequency components. However, this approach requires retraining the model after each predicted change point, which is computationally expensive and unsuitable for real-time applications.

Dynamic Mode Decomposition (DMD) emerges as a suitable method for CPD in both time and frequency domain. DMD is a data-driven technique that decomposes a time series into its dominant frequency components (modes), described by their oscillation and magnitudes. By approximating the dynamical system through a linear combination of these modes, DMD facilitates interpretable CPD concerning system dynamics. It allows for monitoring changes in spatial features and system dynamics and detecting changes arising from environmental factors.

Supporting this claim, \citet{Prasadan2020} applied DMD to a data matrix composed of linearly independent, additive mixtures of latent time series, focusing on missing data recovery. They demonstrated that hankelized DMD, a higher-lag extension of DMD, could unmix signals, revealing them better in noise and offering superior reconstruction compared to Principal Component Analysis (PCA) and Independent Components Analysis (ICA).

In another study, \citet{Srivastava2017} introduced an innovative offline algorithm leveraging DMD to iteratively detect variance change points. Their method integrates a data-driven dynamical system with a local adaptive window guided by a variance descriptor function, facilitating the identification of change points at various scales. By employing sequential hypothesis testing and a dynamic window mechanism, the method dynamically adjusts the window's location and size to detect changes in variance. This offline algorithm performs multiple passes over the data to first identify the longest stationary segments and then detect variance change points, making it unsuitable for real-time applications.

Similarly, \citet{Gottwald2020} focused on detecting transient dynamics and regime changes in time series using DMD. They argued that transitions between different dynamical regimes are often reflected in higher-dimensional space, followed by relaxation to lower-dimensional space. They proposed using the reconstruction error of DMD to monitor a time series' inability to resolve fast relaxation towards the attractor and the system dynamics' effective dimension.

Similarly, \citet{Gottwald2020} focused on detecting transient dynamics and regime changes in time series using DMD. They argued that transitions between different dynamical regimes are often reflected in higher-dimensional space, followed by relaxation to lower-dimensional space. They proposed using the reconstruction error of DMD to monitor a time series' inability to resolve fast relaxation towards the attractor and the system dynamics' effective dimension.

\subsection{Research Objective and contributions}
This paper proposes an online change-point detection (CPD) method based on Dynamic Mode Decomposition (DMD) with control. We leverage DMD's capability to decompose time series into dominant frequency components and incorporate control effects to adapt to changing system behaviors. The proposed method detects abrupt changes in system behavior considering both the time and frequency domains. We demonstrate the effectiveness of this approach on real-world data streams, showing that it is highly competitive or superior to other general CPD methods in terms of detection accuracy on benchmark datasets.

The significance of this work is underscored in industrial settings where complex dynamical systems are challenging to describe, data arrive at non-uniform rates, and real-time assessment of changes is crucial to protecting both profit and life.

The main contributions of this paper are:
\begin{itemize}
    \item Formulation of a truncated version of online DMD with control for tracking system dynamics.
    \item Utilization of higher-order time-delay embeddings in streamed data to extract broad-band features.
    \item Demonstration that the using DMD improves the detection accuracy comparing to SVD-based CPD methods.
    \item Analysis of the correspondence between increases in detection statistics and the actual dissimilarity of compared intervals.
    \item Validation of the proposed method's effectiveness on real-world data from a controlled dynamical system.
    \item Provision of intuitive guidelines for selecting hyperparameters for the proposed method.
\end{itemize}
